# SmanAgent é…ç½®æ–‡ä»¶
# æ”¯æŒç¯å¢ƒå˜é‡å ä½ç¬¦ï¼š${ENV_VAR_NAME}

# ==================== LLM API é…ç½® ====================
llm.api.key=${LLM_API_KEY}
# ä½¿ç”¨ coding ä¸“ç”¨ç«¯ç‚¹ï¼ˆä¸ agent é¡¹ç›®ä¿æŒä¸€è‡´ï¼‰
llm.base.url=https://open.bigmodel.cn/api/coding/paas/v4
llm.model.name=GLM-4.7
llm.response.max.tokens=28192

# ==================== é‡è¯•é…ç½® ====================
# æœ€å¤§é‡è¯•æ¬¡æ•°
llm.retry.max=3
# é‡è¯•åŸºç¡€å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
# 429 é”™è¯¯éœ€è¦æ›´é•¿çš„ç­‰å¾…æ—¶é—´ï¼Œå»ºè®®è‡³å°‘ 5 ç§’
llm.retry.base.delay=5000

# ==================== è¶…æ—¶é…ç½®ï¼ˆæ¯«ç§’ï¼‰===================
llm.timeout.connect=30000
llm.timeout.read=300000
llm.timeout.write=30000

# ==================== ReAct å¾ªç¯é…ç½® ====================
react.max.steps=25
react.enable.streaming=true

# ==================== ä¸Šä¸‹æ–‡å‹ç¼©é…ç½® ====================
compaction.max.tokens=100000
compaction.threshold=80000
compaction.enable.intelligent=true

# ==================== æ¨¡å‹å‚æ•°é…ç½® ====================
llm.temperature=0.0
llm.default.max.tokens=4096

# ==================== å‘é‡æ•°æ®åº“é…ç½® ====================
# å‘é‡æ•°æ®åº“ç±»å‹: JVECTOR, MEMORY, MILVUS, CHROMA, PGVECTOR
vector.db.type=JVECTOR
vector.db.dimension=1024

# JVector é…ç½®ï¼ˆL2 æ¸©æ•°æ®ç´¢å¼•ï¼‰
# HNSW å‚æ•°è¯´æ˜ï¼š
# - dimension: BGE-M3 å‘é‡ç»´åº¦ (1024)
# - M: HNSW å›¾è¿æ¥æ•° (8-32, æ¨è 16)
# - efConstruction: HNSW æ„å»ºå‚æ•° (50-200, æ¨è 100)
# - efSearch: HNSW æœç´¢å‚æ•° (20-100, æ¨è 50)
# - enablePersist: æ˜¯å¦å¯ç”¨ç£ç›˜æŒä¹…åŒ–
# - rerankerThreshold: Reranker ç›¸ä¼¼åº¦é˜ˆå€¼ (0.0-1.0, ä»…å®šä¹‰æœªä½¿ç”¨)
vector.db.jvector.dimension=1024
vector.db.jvector.M=16
vector.db.jvector.efConstruction=100
vector.db.jvector.efSearch=50
vector.db.jvector.enablePersist=true
vector.db.jvector.rerankerThreshold=0.1

# L1/L2/L3 ä¸‰å±‚ç¼“å­˜é…ç½®
# L1 (Hot): å†…å­˜ LRU ç¼“å­˜ï¼Œå­˜å‚¨æœ€è¿‘è®¿é—®çš„çƒ­ç‚¹æ•°æ®
# - å°å‹é¡¹ç›®: 100-500
# - ä¸­å‹é¡¹ç›®: 500-1000
# - å¤§å‹é¡¹ç›®: 1000-2000
vector.db.l1.cache.size=500

# H2 æ•°æ®åº“è¯´æ˜ï¼š
# - H2 æ˜¯åµŒå…¥å¼æ•°æ®åº“ï¼Œæ— éœ€å¤–éƒ¨å®‰è£…
# - è·¯å¾„è‡ªåŠ¨æŒ‰é¡¹ç›®éš”ç¦»ï¼š~/.smanunion/{projectKey}/analysis.mv.db
# - æ— éœ€æ‰‹åŠ¨é…ç½®è·¯å¾„ï¼Œç”± VectorDatabaseConfig.create() è‡ªåŠ¨ç®¡ç†

# ==================== BGE-M3 å‘é‡åŒ–é…ç½® ====================
# BGE-M3 æœåŠ¡ç«¯ç‚¹ï¼ˆéœ€è‡ªè¡Œéƒ¨ç½²ï¼‰
# å¦‚éœ€å¯ç”¨è¯­ä¹‰æœç´¢ï¼Œè¯·å…ˆéƒ¨ç½² BGE-M3 æœåŠ¡
# æ³¨æ„ï¼šåªå¡«å†™åŸºç¡€ URLï¼Œä¸è¦åŒ…å« /v1/embeddings
bge.endpoint=http://localhost:8000
bge.model.name=BAAI/bge-m3
bge.dimension=1024
bge.timeout.seconds=30
bge.batch.size=10

# BGE Token é™åˆ¶ï¼ˆé»˜è®¤ 8192ï¼‰
bge.max.tokens=8192

# BGE æˆªæ–­é…ç½®
# æˆªæ–­ç­–ç•¥: HEAD, TAIL, MIDDLE, SMART
bge.truncation.strategy=TAIL
bge.truncation.step.size=1000
bge.max.truncation.retries=10

# BGE é‡è¯•é…ç½®
bge.retry.max=3
bge.retry.base.delay=1000

# BGE å¹¶å‘é…ç½®
bge.concurrent.limit=3

# BGE ç†”æ–­å™¨é…ç½®
bge.circuit.breaker.threshold=5

# ==================== BGE-Reranker é…ç½® ====================
# ğŸ”¥ Reranker é‡æ’æœåŠ¡é…ç½®ï¼ˆæå‡æœç´¢æ•ˆç‡ 10 å€+ï¼‰
# éœ€è‡ªè¡Œéƒ¨ç½² BGE-Reranker æœåŠ¡
reranker.enabled=true
reranker.base.url=http://localhost:8001/v1
reranker.model=BAAI/bge-reranker-v2-m3
reranker.api.key=
reranker.timeout.seconds=30
reranker.retry=2
reranker.max.rounds=3
reranker.top.k=15
# Reranker ç›¸ä¼¼åº¦é˜ˆå€¼ (0.0-1.0, æ¨è 0.1)
reranker.threshold=0.1

# ==================== é¡¹ç›®åˆ†æé…ç½® ====================
# å¼ºåˆ¶åˆ·æ–°é¡¹ç›®åˆ†æï¼ˆè·³è¿‡ MD5 ç¼“å­˜ï¼‰
# å¼€å‘é˜¶æ®µè®¾ç½®ä¸º trueï¼Œæ¯æ¬¡éƒ½é‡æ–°åˆ†æ
# ç”Ÿäº§ç¯å¢ƒè®¾ç½®ä¸º falseï¼Œåˆ©ç”¨ MD5 ç¼“å­˜æå‡æ€§èƒ½
analysis.force.refresh=true

# ==================== LLM ä»£ç å‘é‡åŒ–é…ç½® ====================
# æ˜¯å¦å¯ç”¨ LLM é©±åŠ¨çš„ä»£ç å‘é‡åŒ–ï¼ˆé»˜è®¤ falseï¼‰
# å¯ç”¨åä¼šå¯¹æ¯ä¸ªæºæ–‡ä»¶è°ƒç”¨ LLM è¿›è¡Œç²¾è¯»åˆ†æï¼Œç”Ÿæˆä¸šåŠ¡æè¿°
# æ³¨æ„ï¼šé¦–æ¬¡å¯ç”¨ä¼šå¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œåç»­åªåˆ†æå˜åŒ–çš„æ–‡ä»¶ï¼ˆåŸºäº MD5ï¼‰
analysis.llm.vectorization.enabled=true

# LLM ä»£ç å‘é‡åŒ–å…¨é‡åˆ·æ–°ï¼ˆé»˜è®¤ falseï¼‰
# è®¾ç½®ä¸º true æ—¶ï¼Œä¼šå¿½ç•¥ MD5 ç¼“å­˜ï¼Œå¯¹æ‰€æœ‰æ–‡ä»¶é‡æ–°è¿›è¡Œ LLM åˆ†æ
# ä»…åœ¨éœ€è¦å®Œå…¨é‡å»ºå‘é‡æ•°æ®æ—¶ä½¿ç”¨ï¼ˆå¦‚ LLM prompt æ›´æ–°åï¼‰
analysis.llm.vectorization.full.refresh=false
